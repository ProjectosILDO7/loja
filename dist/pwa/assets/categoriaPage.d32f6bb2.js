import{_ as q,r as c,o as x,aK as m,L as k,M as C,N as l,aL as O,aM as w,f as o,$ as F,aN as I,aO as Q,Q as b,q as f,O as P,Y as S}from"./index.c57e1df5.js";import{Q as z}from"./QForm.57222d6e.js";import{Q as D}from"./QSpace.fae20777.js";import{Q as B}from"./QTd.545bfc1a.js";import{Q as M}from"./QTable.c75b471b.js";import{Q as L}from"./QPage.39b9a795.js";import{Q as T,a as U}from"./QLayout.031ceddd.js";import{db as u}from"./localbase.0d6b512d.js";import"./QMenu.12cb183b.js";import"./format.609662aa.js";import"./rtl.b51694b1.js";const A=[{name:"categoria",field:"categoria",label:"nome de categoria",sortable:!0,align:"left"},{name:"data",field:"data",label:"Data de registro",sortable:!0,align:"left"},{name:"options",field:"options",label:"Op\xE7\xF5es",align:"left"}],J={components:{},setup(){const s="categorias",i=c(""),p=c(!0),e=c(""),g=c([]),n=c(!1),a=c({categoria:"",data:new Date().toJSON().slice(0,10)}),d=()=>{a.value={categoria:"",data:new Date().toJSON().slice(0,10)}},h=async r=>{try{const t=await u.collection(s).doc(r).get();a.value.categoria=t.categoria,e.value=r,n.value=!0}catch(t){console.log(t.message)}},_=()=>{n.value=!0,e.value=""},N=r=>{O.create({title:"Confirme",message:"Tens a certeza que pretendes apagar essa categoria?",cancel:!0,persistent:!0}).onOk(async()=>{await u.collection(s).doc(r).delete(),v()}).onOk(()=>{}).onCancel(()=>{}).onDismiss(()=>{})},V=async()=>{try{if(g.value.find(t=>t.categoria===a.value.categoria)){m.create({message:"A categoria que pretendes registrar j\xE1 existe",position:"top",icon:"mdi-check-circle",color:"red-10"});return}else if(e.value){w.show();const{categoria:t,data:y}=a.value;await u.collection(s).doc(e.value).update({categoria:t,data:y}),m.create({message:"Categoria Actualizada com sucesso",position:"top",icon:"mdi-check-circle",color:"green-10"}),n.value=!1,d()}else{w.show();const{categoria:t,data:y}=a.value;await u.collection(s).add({categoria:t,data:y}),m.create({message:"Categoria salva com sucesso",position:"top",icon:"mdi-check-circle",color:"green-10"}),n.value=!1,d()}}catch(r){m.create({message:r.message,position:"top",icon:"mdi-close-circle-outline",color:"red-10"})}finally{w.hide(),v()}};x(()=>{v()});const v=async()=>{try{p.value=!0;const r=await u.collection(s).get({keys:!0});g.value=r.map(t=>({...t.data,key:t.key}))}catch(r){m.create({message:r.message,position:"top",icon:"mdi-close-circle-outline",color:"red-10"})}finally{p.value=!1}};return{columns:A,rows:g,loading:!1,addCategoria:V,filter:i,deleteItem:N,form:a,showForm:_,formularioCad:n,cleanForm:d,editForm:h}}},R=S("p",{class:"text-body1"},"Informa\xE7\xF5es de categorias",-1);function j(s,i,p,e,g,n){return k(),C(T,null,{default:l(()=>[o(U,null,{default:l(()=>[o(L,{padding:""},{default:l(()=>[R,o(F),e.formularioCad?(k(),C(z,{key:0,onSubmit:I(e.addCategoria,["prevent"])},{default:l(()=>[o(Q,{outlined:"",dense:"",type:"text",label:"Nova categoria",class:"q-mt-sm",modelValue:e.form.categoria,"onUpdate:modelValue":i[0]||(i[0]=a=>e.form.categoria=a),"lazy-rules":"",rules:[a=>a&&a.length>0||"Porfavor informe o nome da categoria"]},{prepend:l(()=>[o(b,{name:"mdi-shape-plus"})]),_:1},8,["modelValue","rules"]),o(f,{type:"submit",dense:"",color:"green-10",class:"full-width q-mt-sm",label:"Cadastrar categoria",icon:"mdi-content-save-outline"})]),_:1},8,["onSubmit"])):P("",!0),o(M,{dense:"",rows:e.rows,columns:e.columns,"row-key":"name",class:"q-mt-md",loading:e.loading,filter:e.filter},{top:l(()=>[o(Q,{dense:"",outlined:"",class:"",label:"Procurar",modelValue:e.filter,"onUpdate:modelValue":i[1]||(i[1]=a=>e.filter=a)},{append:l(()=>[o(b,{name:"mdi-magnify"})]),_:1},8,["modelValue"]),o(D),o(f,{dense:"",icon:"mdi-shape-plus",label:"Nova categoria",color:"green-10","no-caps":"",onClick:e.showForm},null,8,["onClick"])]),"body-cell-options":l(a=>[o(B,{props:a,class:"q-gutter-sm"},{default:l(()=>[o(f,{size:"sm",flat:"",outline:"",dense:"",icon:"mdi-file-edit",color:"green-10",onClick:d=>e.editForm(a.row.key)},null,8,["onClick"]),o(f,{size:"sm",flat:"",outline:"",dense:"",icon:"mdi-delete-outline",color:"red-10",onClick:d=>e.deleteItem(a.row.key)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","loading","filter"])]),_:1})]),_:1})]),_:1})}var oe=q(J,[["render",j]]);export{oe as default};
